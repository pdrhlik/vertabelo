---
title: "South Park naughty characters"
author: "Patrik Drhlik"
date: "October 2, 2018"
output: 
  html_document: 
    css: main.css
    fig_caption: yes
    keep_md: yes
---







*Teaser intro (2-3 sentences)*

In the [previous article of the series](https://academy.vertabelo.com/blog/south-park-text-data-analysis-with-r/), I've shown you how to use R to analyze South Park dialogs. It was mostly focused on the show in overall. I'll take a closer look at some characters.

## Characters, their counts and speach amount


```r
print(length(unique(episode_words$character)))
```

```
## [1] 4525
```

```r
g <- ggplot(by_episode, aes(episode_number, n_characters)) +
	geom_point(color = vertabelo_color, alpha = 0.6, size = 3) +
	geom_smooth() +
	labs(
		x = "Episode number",
		y = "Number of characters in an episode"
	)

ggplotly(g)
```

<!--html_preserve--><div id="5db4c395989" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="5db4c395989">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287],"y":[38,41,29,55,37,44,45,43,47,36,27,35,38,38,52,43,50,46,43,50,51,52,24,50,34,38,49,29,56,43,34,41,57,28,53,30,43,18,37,36,51,46,29,39,46,46,35,34,38,48,54,70,49,45,49,31,39,53,31,38,38,17,59,37,44,66,41,40,28,47,36,38,31,51,29,45,60,36,27,37,40,38,31,34,34,25,44,40,41,41,48,39,42,48,31,33,28,54,26,45,37,41,39,57,38,56,15,44,36,32,47,33,25,44,48,23,25,49,31,30,44,24,46,33,35,26,41,24,48,57,32,35,65,27,22,29,27,38,39,38,39,39,43,37,25,22,36,33,7,46,26,47,39,32,21,36,44,37,40,51,33,25,37,51,55,30,37,28,62,23,45,45,45,37,32,29,49,44,45,35,36,47,42,50,49,36,36,43,39,37,56,49,42,30,37,52,49,40,34,51,44,31,36,42,37,50,33,25,27,35,40,42,42,14,23,27,42,39,30,52,42,43,46,47,27,45,25,35,24,31,43,35,43,45,39,35,46,39,34,45,31,37,32,47,38,44,34,44,47,30,49,30,24,17,45,39,45,41,51,33,47,29,32,44,49,32,31,50,29,42,27,59,44,36,47,32,36,35,43,29,40,33,38,34,37,34,34],"text":["~episode_number:   1<br />~n_characters: 38","~episode_number:   2<br />~n_characters: 41","~episode_number:   3<br />~n_characters: 29","~episode_number:   4<br />~n_characters: 55","~episode_number:   5<br />~n_characters: 37","~episode_number:   6<br />~n_characters: 44","~episode_number:   7<br />~n_characters: 45","~episode_number:   8<br />~n_characters: 43","~episode_number:   9<br />~n_characters: 47","~episode_number:  10<br />~n_characters: 36","~episode_number:  11<br />~n_characters: 27","~episode_number:  12<br />~n_characters: 35","~episode_number:  13<br />~n_characters: 38","~episode_number:  14<br />~n_characters: 38","~episode_number:  15<br />~n_characters: 52","~episode_number:  16<br />~n_characters: 43","~episode_number:  17<br />~n_characters: 50","~episode_number:  18<br />~n_characters: 46","~episode_number:  19<br />~n_characters: 43","~episode_number:  20<br />~n_characters: 50","~episode_number:  21<br />~n_characters: 51","~episode_number:  22<br />~n_characters: 52","~episode_number:  23<br />~n_characters: 24","~episode_number:  24<br />~n_characters: 50","~episode_number:  25<br />~n_characters: 34","~episode_number:  26<br />~n_characters: 38","~episode_number:  27<br />~n_characters: 49","~episode_number:  28<br />~n_characters: 29","~episode_number:  29<br />~n_characters: 56","~episode_number:  30<br />~n_characters: 43","~episode_number:  31<br />~n_characters: 34","~episode_number:  32<br />~n_characters: 41","~episode_number:  33<br />~n_characters: 57","~episode_number:  34<br />~n_characters: 28","~episode_number:  35<br />~n_characters: 53","~episode_number:  36<br />~n_characters: 30","~episode_number:  37<br />~n_characters: 43","~episode_number:  38<br />~n_characters: 18","~episode_number:  39<br />~n_characters: 37","~episode_number:  40<br />~n_characters: 36","~episode_number:  41<br />~n_characters: 51","~episode_number:  42<br />~n_characters: 46","~episode_number:  43<br />~n_characters: 29","~episode_number:  44<br />~n_characters: 39","~episode_number:  45<br />~n_characters: 46","~episode_number:  46<br />~n_characters: 46","~episode_number:  47<br />~n_characters: 35","~episode_number:  48<br />~n_characters: 34","~episode_number:  49<br />~n_characters: 38","~episode_number:  50<br />~n_characters: 48","~episode_number:  51<br />~n_characters: 54","~episode_number:  52<br />~n_characters: 70","~episode_number:  53<br />~n_characters: 49","~episode_number:  54<br />~n_characters: 45","~episode_number:  55<br />~n_characters: 49","~episode_number:  56<br />~n_characters: 31","~episode_number:  57<br />~n_characters: 39","~episode_number:  58<br />~n_characters: 53","~episode_number:  59<br />~n_characters: 31","~episode_number:  60<br />~n_characters: 38","~episode_number:  61<br />~n_characters: 38","~episode_number:  62<br />~n_characters: 17","~episode_number:  63<br />~n_characters: 59","~episode_number:  64<br />~n_characters: 37","~episode_number:  65<br />~n_characters: 44","~episode_number:  66<br />~n_characters: 66","~episode_number:  67<br />~n_characters: 41","~episode_number:  68<br />~n_characters: 40","~episode_number:  69<br />~n_characters: 28","~episode_number:  70<br />~n_characters: 47","~episode_number:  71<br />~n_characters: 36","~episode_number:  72<br />~n_characters: 38","~episode_number:  73<br />~n_characters: 31","~episode_number:  74<br />~n_characters: 51","~episode_number:  75<br />~n_characters: 29","~episode_number:  76<br />~n_characters: 45","~episode_number:  77<br />~n_characters: 60","~episode_number:  78<br />~n_characters: 36","~episode_number:  79<br />~n_characters: 27","~episode_number:  80<br />~n_characters: 37","~episode_number:  81<br />~n_characters: 40","~episode_number:  82<br />~n_characters: 38","~episode_number:  83<br />~n_characters: 31","~episode_number:  84<br />~n_characters: 34","~episode_number:  85<br />~n_characters: 34","~episode_number:  86<br />~n_characters: 25","~episode_number:  87<br />~n_characters: 44","~episode_number:  88<br />~n_characters: 40","~episode_number:  89<br />~n_characters: 41","~episode_number:  90<br />~n_characters: 41","~episode_number:  91<br />~n_characters: 48","~episode_number:  92<br />~n_characters: 39","~episode_number:  93<br />~n_characters: 42","~episode_number:  94<br />~n_characters: 48","~episode_number:  95<br />~n_characters: 31","~episode_number:  96<br />~n_characters: 33","~episode_number:  97<br />~n_characters: 28","~episode_number:  98<br />~n_characters: 54","~episode_number:  99<br />~n_characters: 26","~episode_number: 100<br />~n_characters: 45","~episode_number: 101<br />~n_characters: 37","~episode_number: 102<br />~n_characters: 41","~episode_number: 103<br />~n_characters: 39","~episode_number: 104<br />~n_characters: 57","~episode_number: 105<br />~n_characters: 38","~episode_number: 106<br />~n_characters: 56","~episode_number: 107<br />~n_characters: 15","~episode_number: 108<br />~n_characters: 44","~episode_number: 109<br />~n_characters: 36","~episode_number: 110<br />~n_characters: 32","~episode_number: 111<br />~n_characters: 47","~episode_number: 112<br />~n_characters: 33","~episode_number: 113<br />~n_characters: 25","~episode_number: 114<br />~n_characters: 44","~episode_number: 115<br />~n_characters: 48","~episode_number: 116<br />~n_characters: 23","~episode_number: 117<br />~n_characters: 25","~episode_number: 118<br />~n_characters: 49","~episode_number: 119<br />~n_characters: 31","~episode_number: 120<br />~n_characters: 30","~episode_number: 121<br />~n_characters: 44","~episode_number: 122<br />~n_characters: 24","~episode_number: 123<br />~n_characters: 46","~episode_number: 124<br />~n_characters: 33","~episode_number: 125<br />~n_characters: 35","~episode_number: 126<br />~n_characters: 26","~episode_number: 127<br />~n_characters: 41","~episode_number: 128<br />~n_characters: 24","~episode_number: 129<br />~n_characters: 48","~episode_number: 130<br />~n_characters: 57","~episode_number: 131<br />~n_characters: 32","~episode_number: 132<br />~n_characters: 35","~episode_number: 133<br />~n_characters: 65","~episode_number: 134<br />~n_characters: 27","~episode_number: 135<br />~n_characters: 22","~episode_number: 136<br />~n_characters: 29","~episode_number: 137<br />~n_characters: 27","~episode_number: 138<br />~n_characters: 38","~episode_number: 139<br />~n_characters: 39","~episode_number: 140<br />~n_characters: 38","~episode_number: 141<br />~n_characters: 39","~episode_number: 142<br />~n_characters: 39","~episode_number: 143<br />~n_characters: 43","~episode_number: 144<br />~n_characters: 37","~episode_number: 145<br />~n_characters: 25","~episode_number: 146<br />~n_characters: 22","~episode_number: 147<br />~n_characters: 36","~episode_number: 148<br />~n_characters: 33","~episode_number: 149<br />~n_characters:  7","~episode_number: 150<br />~n_characters: 46","~episode_number: 151<br />~n_characters: 26","~episode_number: 152<br />~n_characters: 47","~episode_number: 153<br />~n_characters: 39","~episode_number: 154<br />~n_characters: 32","~episode_number: 155<br />~n_characters: 21","~episode_number: 156<br />~n_characters: 36","~episode_number: 157<br />~n_characters: 44","~episode_number: 158<br />~n_characters: 37","~episode_number: 159<br />~n_characters: 40","~episode_number: 160<br />~n_characters: 51","~episode_number: 161<br />~n_characters: 33","~episode_number: 162<br />~n_characters: 25","~episode_number: 163<br />~n_characters: 37","~episode_number: 164<br />~n_characters: 51","~episode_number: 165<br />~n_characters: 55","~episode_number: 166<br />~n_characters: 30","~episode_number: 167<br />~n_characters: 37","~episode_number: 168<br />~n_characters: 28","~episode_number: 169<br />~n_characters: 62","~episode_number: 170<br />~n_characters: 23","~episode_number: 171<br />~n_characters: 45","~episode_number: 172<br />~n_characters: 45","~episode_number: 173<br />~n_characters: 45","~episode_number: 174<br />~n_characters: 37","~episode_number: 175<br />~n_characters: 32","~episode_number: 176<br />~n_characters: 29","~episode_number: 177<br />~n_characters: 49","~episode_number: 178<br />~n_characters: 44","~episode_number: 179<br />~n_characters: 45","~episode_number: 180<br />~n_characters: 35","~episode_number: 181<br />~n_characters: 36","~episode_number: 182<br />~n_characters: 47","~episode_number: 183<br />~n_characters: 42","~episode_number: 184<br />~n_characters: 50","~episode_number: 185<br />~n_characters: 49","~episode_number: 186<br />~n_characters: 36","~episode_number: 187<br />~n_characters: 36","~episode_number: 188<br />~n_characters: 43","~episode_number: 189<br />~n_characters: 39","~episode_number: 190<br />~n_characters: 37","~episode_number: 191<br />~n_characters: 56","~episode_number: 192<br />~n_characters: 49","~episode_number: 193<br />~n_characters: 42","~episode_number: 194<br />~n_characters: 30","~episode_number: 195<br />~n_characters: 37","~episode_number: 196<br />~n_characters: 52","~episode_number: 197<br />~n_characters: 49","~episode_number: 198<br />~n_characters: 40","~episode_number: 199<br />~n_characters: 34","~episode_number: 200<br />~n_characters: 51","~episode_number: 201<br />~n_characters: 44","~episode_number: 202<br />~n_characters: 31","~episode_number: 203<br />~n_characters: 36","~episode_number: 204<br />~n_characters: 42","~episode_number: 205<br />~n_characters: 37","~episode_number: 206<br />~n_characters: 50","~episode_number: 207<br />~n_characters: 33","~episode_number: 208<br />~n_characters: 25","~episode_number: 209<br />~n_characters: 27","~episode_number: 210<br />~n_characters: 35","~episode_number: 211<br />~n_characters: 40","~episode_number: 212<br />~n_characters: 42","~episode_number: 213<br />~n_characters: 42","~episode_number: 214<br />~n_characters: 14","~episode_number: 215<br />~n_characters: 23","~episode_number: 216<br />~n_characters: 27","~episode_number: 217<br />~n_characters: 42","~episode_number: 218<br />~n_characters: 39","~episode_number: 219<br />~n_characters: 30","~episode_number: 220<br />~n_characters: 52","~episode_number: 221<br />~n_characters: 42","~episode_number: 222<br />~n_characters: 43","~episode_number: 223<br />~n_characters: 46","~episode_number: 224<br />~n_characters: 47","~episode_number: 225<br />~n_characters: 27","~episode_number: 226<br />~n_characters: 45","~episode_number: 227<br />~n_characters: 25","~episode_number: 228<br />~n_characters: 35","~episode_number: 229<br />~n_characters: 24","~episode_number: 230<br />~n_characters: 31","~episode_number: 231<br />~n_characters: 43","~episode_number: 232<br />~n_characters: 35","~episode_number: 233<br />~n_characters: 43","~episode_number: 234<br />~n_characters: 45","~episode_number: 235<br />~n_characters: 39","~episode_number: 236<br />~n_characters: 35","~episode_number: 237<br />~n_characters: 46","~episode_number: 238<br />~n_characters: 39","~episode_number: 239<br />~n_characters: 34","~episode_number: 240<br />~n_characters: 45","~episode_number: 241<br />~n_characters: 31","~episode_number: 242<br />~n_characters: 37","~episode_number: 243<br />~n_characters: 32","~episode_number: 244<br />~n_characters: 47","~episode_number: 245<br />~n_characters: 38","~episode_number: 246<br />~n_characters: 44","~episode_number: 247<br />~n_characters: 34","~episode_number: 248<br />~n_characters: 44","~episode_number: 249<br />~n_characters: 47","~episode_number: 250<br />~n_characters: 30","~episode_number: 251<br />~n_characters: 49","~episode_number: 252<br />~n_characters: 30","~episode_number: 253<br />~n_characters: 24","~episode_number: 254<br />~n_characters: 17","~episode_number: 255<br />~n_characters: 45","~episode_number: 256<br />~n_characters: 39","~episode_number: 257<br />~n_characters: 45","~episode_number: 258<br />~n_characters: 41","~episode_number: 259<br />~n_characters: 51","~episode_number: 260<br />~n_characters: 33","~episode_number: 261<br />~n_characters: 47","~episode_number: 262<br />~n_characters: 29","~episode_number: 263<br />~n_characters: 32","~episode_number: 264<br />~n_characters: 44","~episode_number: 265<br />~n_characters: 49","~episode_number: 266<br />~n_characters: 32","~episode_number: 267<br />~n_characters: 31","~episode_number: 268<br />~n_characters: 50","~episode_number: 269<br />~n_characters: 29","~episode_number: 270<br />~n_characters: 42","~episode_number: 271<br />~n_characters: 27","~episode_number: 272<br />~n_characters: 59","~episode_number: 273<br />~n_characters: 44","~episode_number: 274<br />~n_characters: 36","~episode_number: 275<br />~n_characters: 47","~episode_number: 276<br />~n_characters: 32","~episode_number: 277<br />~n_characters: 36","~episode_number: 278<br />~n_characters: 35","~episode_number: 279<br />~n_characters: 43","~episode_number: 280<br />~n_characters: 29","~episode_number: 281<br />~n_characters: 40","~episode_number: 282<br />~n_characters: 33","~episode_number: 283<br />~n_characters: 38","~episode_number: 284<br />~n_characters: 34","~episode_number: 285<br />~n_characters: 37","~episode_number: 286<br />~n_characters: 34","~episode_number: 287<br />~n_characters: 34"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(89,42,136,1)","opacity":0.6,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(89,42,136,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,4.62025316455696,8.24050632911392,11.8607594936709,15.4810126582278,19.1012658227848,22.7215189873418,26.3417721518987,29.9620253164557,33.5822784810127,37.2025316455696,40.8227848101266,44.4430379746835,48.0632911392405,51.6835443037975,55.3037974683544,58.9240506329114,62.5443037974684,66.1645569620253,69.7848101265823,73.4050632911392,77.0253164556962,80.6455696202532,84.2658227848101,87.8860759493671,91.5063291139241,95.126582278481,98.746835443038,102.367088607595,105.987341772152,109.607594936709,113.227848101266,116.848101265823,120.46835443038,124.088607594937,127.708860759494,131.329113924051,134.949367088608,138.569620253165,142.189873417722,145.810126582278,149.430379746835,153.050632911392,156.670886075949,160.291139240506,163.911392405063,167.53164556962,171.151898734177,174.772151898734,178.392405063291,182.012658227848,185.632911392405,189.253164556962,192.873417721519,196.493670886076,200.113924050633,203.73417721519,207.354430379747,210.974683544304,214.594936708861,218.215189873418,221.835443037975,225.455696202532,229.075949367089,232.696202531646,236.316455696203,239.936708860759,243.556962025316,247.177215189873,250.79746835443,254.417721518987,258.037974683544,261.658227848101,265.278481012658,268.898734177215,272.518987341772,276.139240506329,279.759493670886,283.379746835443,287],"y":[42.5377200902778,42.4185011723283,42.2989613985208,42.1781455532306,42.0550984208335,41.9288647857047,41.7984894322199,41.6630171447546,41.5214927076842,41.3729609053842,41.2163111905038,41.0495042314685,40.8739247043511,40.6918234893066,40.5054514664899,40.3170595160557,40.1288985181591,39.9432193529547,39.7622729005976,39.5883100412427,39.4191343748215,39.2161700488595,38.9785567750543,38.7170170346979,38.4422733090819,38.1650480794983,37.8960638272388,37.6460430335953,37.4257081798596,37.2457817473234,37.1152290165059,37.0259074751609,36.9706289557945,36.9441364303073,36.9411728705997,36.9564812485723,36.9848045361255,37.0208857051598,37.0594677275758,37.0952935752739,37.1322515865288,37.2173232375066,37.3476663152025,37.5110006075731,37.695045902575,37.8875219881648,38.0761486522992,38.2486456829347,38.3927328680281,38.496129995536,38.5555618329117,38.6068259441469,38.654310109881,38.6970282048911,38.7339941039542,38.7642216818475,38.7867248133481,38.8005173732331,38.8046132362796,38.7980262772647,38.7804952716269,38.754267270504,38.7194975729218,38.6760717203701,38.6238752543387,38.5627937163173,38.4927126477956,38.4135175902635,38.3250940852106,38.2273276741267,38.1204856863813,38.0057189351663,37.883069779165,37.7524872952879,37.6139205604452,37.4673186515471,37.3126306455041,37.1498056192264,36.9787926496244,36.7995408136082],"text":["~episode_number:   1.000000<br />~n_characters: 42.53772","~episode_number:   4.620253<br />~n_characters: 42.41850","~episode_number:   8.240506<br />~n_characters: 42.29896","~episode_number:  11.860759<br />~n_characters: 42.17815","~episode_number:  15.481013<br />~n_characters: 42.05510","~episode_number:  19.101266<br />~n_characters: 41.92886","~episode_number:  22.721519<br />~n_characters: 41.79849","~episode_number:  26.341772<br />~n_characters: 41.66302","~episode_number:  29.962025<br />~n_characters: 41.52149","~episode_number:  33.582278<br />~n_characters: 41.37296","~episode_number:  37.202532<br />~n_characters: 41.21631","~episode_number:  40.822785<br />~n_characters: 41.04950","~episode_number:  44.443038<br />~n_characters: 40.87392","~episode_number:  48.063291<br />~n_characters: 40.69182","~episode_number:  51.683544<br />~n_characters: 40.50545","~episode_number:  55.303797<br />~n_characters: 40.31706","~episode_number:  58.924051<br />~n_characters: 40.12890","~episode_number:  62.544304<br />~n_characters: 39.94322","~episode_number:  66.164557<br />~n_characters: 39.76227","~episode_number:  69.784810<br />~n_characters: 39.58831","~episode_number:  73.405063<br />~n_characters: 39.41913","~episode_number:  77.025316<br />~n_characters: 39.21617","~episode_number:  80.645570<br />~n_characters: 38.97856","~episode_number:  84.265823<br />~n_characters: 38.71702","~episode_number:  87.886076<br />~n_characters: 38.44227","~episode_number:  91.506329<br />~n_characters: 38.16505","~episode_number:  95.126582<br />~n_characters: 37.89606","~episode_number:  98.746835<br />~n_characters: 37.64604","~episode_number: 102.367089<br />~n_characters: 37.42571","~episode_number: 105.987342<br />~n_characters: 37.24578","~episode_number: 109.607595<br />~n_characters: 37.11523","~episode_number: 113.227848<br />~n_characters: 37.02591","~episode_number: 116.848101<br />~n_characters: 36.97063","~episode_number: 120.468354<br />~n_characters: 36.94414","~episode_number: 124.088608<br />~n_characters: 36.94117","~episode_number: 127.708861<br />~n_characters: 36.95648","~episode_number: 131.329114<br />~n_characters: 36.98480","~episode_number: 134.949367<br />~n_characters: 37.02089","~episode_number: 138.569620<br />~n_characters: 37.05947","~episode_number: 142.189873<br />~n_characters: 37.09529","~episode_number: 145.810127<br />~n_characters: 37.13225","~episode_number: 149.430380<br />~n_characters: 37.21732","~episode_number: 153.050633<br />~n_characters: 37.34767","~episode_number: 156.670886<br />~n_characters: 37.51100","~episode_number: 160.291139<br />~n_characters: 37.69505","~episode_number: 163.911392<br />~n_characters: 37.88752","~episode_number: 167.531646<br />~n_characters: 38.07615","~episode_number: 171.151899<br />~n_characters: 38.24865","~episode_number: 174.772152<br />~n_characters: 38.39273","~episode_number: 178.392405<br />~n_characters: 38.49613","~episode_number: 182.012658<br />~n_characters: 38.55556","~episode_number: 185.632911<br />~n_characters: 38.60683","~episode_number: 189.253165<br />~n_characters: 38.65431","~episode_number: 192.873418<br />~n_characters: 38.69703","~episode_number: 196.493671<br />~n_characters: 38.73399","~episode_number: 200.113924<br />~n_characters: 38.76422","~episode_number: 203.734177<br />~n_characters: 38.78672","~episode_number: 207.354430<br />~n_characters: 38.80052","~episode_number: 210.974684<br />~n_characters: 38.80461","~episode_number: 214.594937<br />~n_characters: 38.79803","~episode_number: 218.215190<br />~n_characters: 38.78050","~episode_number: 221.835443<br />~n_characters: 38.75427","~episode_number: 225.455696<br />~n_characters: 38.71950","~episode_number: 229.075949<br />~n_characters: 38.67607","~episode_number: 232.696203<br />~n_characters: 38.62388","~episode_number: 236.316456<br />~n_characters: 38.56279","~episode_number: 239.936709<br />~n_characters: 38.49271","~episode_number: 243.556962<br />~n_characters: 38.41352","~episode_number: 247.177215<br />~n_characters: 38.32509","~episode_number: 250.797468<br />~n_characters: 38.22733","~episode_number: 254.417722<br />~n_characters: 38.12049","~episode_number: 258.037975<br />~n_characters: 38.00572","~episode_number: 261.658228<br />~n_characters: 37.88307","~episode_number: 265.278481<br />~n_characters: 37.75249","~episode_number: 268.898734<br />~n_characters: 37.61392","~episode_number: 272.518987<br />~n_characters: 37.46732","~episode_number: 276.139241<br />~n_characters: 37.31263","~episode_number: 279.759494<br />~n_characters: 37.14981","~episode_number: 283.379747<br />~n_characters: 36.97879","~episode_number: 287.000000<br />~n_characters: 36.79954"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.77952755905512,"color":"rgba(51,102,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,4.62025316455696,8.24050632911392,11.8607594936709,15.4810126582278,19.1012658227848,22.7215189873418,26.3417721518987,29.9620253164557,33.5822784810127,37.2025316455696,40.8227848101266,44.4430379746835,48.0632911392405,51.6835443037975,55.3037974683544,58.9240506329114,62.5443037974684,66.1645569620253,69.7848101265823,73.4050632911392,77.0253164556962,80.6455696202532,84.2658227848101,87.8860759493671,91.5063291139241,95.126582278481,98.746835443038,102.367088607595,105.987341772152,109.607594936709,113.227848101266,116.848101265823,120.46835443038,124.088607594937,127.708860759494,131.329113924051,134.949367088608,138.569620253165,142.189873417722,145.810126582278,149.430379746835,153.050632911392,156.670886075949,160.291139240506,163.911392405063,167.53164556962,171.151898734177,174.772151898734,178.392405063291,182.012658227848,185.632911392405,189.253164556962,192.873417721519,196.493670886076,200.113924050633,203.73417721519,207.354430379747,210.974683544304,214.594936708861,218.215189873418,221.835443037975,225.455696202532,229.075949367089,232.696202531646,236.316455696203,239.936708860759,243.556962025316,247.177215189873,250.79746835443,254.417721518987,258.037974683544,261.658227848101,265.278481012658,268.898734177215,272.518987341772,276.139240506329,279.759493670886,283.379746835443,287,287,287,283.379746835443,279.759493670886,276.139240506329,272.518987341772,268.898734177215,265.278481012658,261.658227848101,258.037974683544,254.417721518987,250.79746835443,247.177215189873,243.556962025316,239.936708860759,236.316455696203,232.696202531646,229.075949367089,225.455696202532,221.835443037975,218.215189873418,214.594936708861,210.974683544304,207.354430379747,203.73417721519,200.113924050633,196.493670886076,192.873417721519,189.253164556962,185.632911392405,182.012658227848,178.392405063291,174.772151898734,171.151898734177,167.53164556962,163.911392405063,160.291139240506,156.670886075949,153.050632911392,149.430379746835,145.810126582278,142.189873417722,138.569620253165,134.949367088608,131.329113924051,127.708860759494,124.088607594937,120.46835443038,116.848101265823,113.227848101266,109.607594936709,105.987341772152,102.367088607595,98.746835443038,95.126582278481,91.5063291139241,87.8860759493671,84.2658227848101,80.6455696202532,77.0253164556962,73.4050632911392,69.7848101265823,66.1645569620253,62.5443037974684,58.9240506329114,55.3037974683544,51.6835443037975,48.0632911392405,44.4430379746835,40.8227848101266,37.2025316455696,33.5822784810127,29.9620253164557,26.3417721518987,22.7215189873418,19.1012658227848,15.4810126582278,11.8607594936709,8.24050632911392,4.62025316455696,1,1],"y":[38.3099954900608,38.5316351323099,38.7299700981987,38.9025778540355,39.0469676461445,39.1606545467031,39.2412872994075,39.2868401941163,39.2958611955756,39.267736035618,39.2027510190553,39.1015091244129,38.9685879314477,38.8096664255999,38.6305068160178,38.4367630422322,38.2338343729978,38.0267783774684,37.8202772493903,37.6186409090749,37.4221355972572,37.1996840092959,36.948784735295,36.6754178751746,36.3861316853796,36.08923596619,35.7954970822415,35.5182739177573,35.2731296145042,35.0770568901638,34.9467492854039,34.8815958031374,34.8630735601196,34.8716255735751,34.8899958480302,34.9059203482889,34.9139415229982,34.915463223875,34.9170157798039,34.9275873424223,34.9645453536771,35.0748712897347,35.2422438339177,35.4401375944458,35.6444850022916,35.8363449655953,36.0036377955669,36.1410902872598,36.2484211960047,36.327650264434,36.3868369757521,36.4542473787915,36.5265409940429,36.5964614598937,36.6581819906459,36.7080800581452,36.7451256538248,36.7707453334737,36.7881271967159,36.8010274997004,36.8108261394591,36.8122716192966,36.8030565974355,36.7810075752089,36.7435787805152,36.6878490658452,36.6105555840888,36.50818081736,36.3770989781549,36.2137675026781,36.015260816615,35.7800874230577,35.5068928285267,35.1952851624755,34.8457103214435,34.4591878768582,34.0370629463089,33.5808143189044,33.0919266096059,32.5718162133912,32.5718162133912,41.0272654138252,40.8656586896428,40.7187969195485,40.5881983446993,40.4754494262361,40.3821307994468,40.3096894281003,40.2592467298033,40.2313504472748,40.2257105561476,40.2408878455752,40.2730891922662,40.3188543631669,40.3748697115024,40.4377383667894,40.5041717281623,40.5711358655314,40.6359385484081,40.6962629217113,40.7501644037946,40.795025054829,40.8210992758432,40.8302894129924,40.8283239728714,40.8203633055498,40.8098062172625,40.7975949498884,40.7820792257191,40.7594045095024,40.7242866900713,40.6646097266379,40.5370445400515,40.3562010786096,40.1486595090314,39.9386990107343,39.7456068028583,39.5818636207004,39.4530887964873,39.3597751852785,39.2999578193805,39.2629998081256,39.2019196753477,39.1263081864446,39.0556675492528,39.0070421488557,38.9923498931692,39.0166472870395,39.0781843514694,39.1702191471843,39.2837087476078,39.4145066044831,39.578286745215,39.7738121494334,39.9966305722362,40.2408601928066,40.4984149327842,40.7586161942211,41.0083288148137,41.2326560884231,41.4161331523859,41.5579791734104,41.704268551805,41.8596603284411,42.0239626633203,42.1973559898793,42.380396116962,42.5739805530134,42.7792614772546,42.9974993385241,43.2298713619523,43.4781857751505,43.7471242197927,44.0391940953929,44.3556915650323,44.6970750247064,45.0632291955224,45.4537132524258,45.8679526988428,46.3053672123468,46.7654446904948,38.3099954900608],"text":["~episode_number:   1.000000<br />~n_characters: 42.53772","~episode_number:   4.620253<br />~n_characters: 42.41850","~episode_number:   8.240506<br />~n_characters: 42.29896","~episode_number:  11.860759<br />~n_characters: 42.17815","~episode_number:  15.481013<br />~n_characters: 42.05510","~episode_number:  19.101266<br />~n_characters: 41.92886","~episode_number:  22.721519<br />~n_characters: 41.79849","~episode_number:  26.341772<br />~n_characters: 41.66302","~episode_number:  29.962025<br />~n_characters: 41.52149","~episode_number:  33.582278<br />~n_characters: 41.37296","~episode_number:  37.202532<br />~n_characters: 41.21631","~episode_number:  40.822785<br />~n_characters: 41.04950","~episode_number:  44.443038<br />~n_characters: 40.87392","~episode_number:  48.063291<br />~n_characters: 40.69182","~episode_number:  51.683544<br />~n_characters: 40.50545","~episode_number:  55.303797<br />~n_characters: 40.31706","~episode_number:  58.924051<br />~n_characters: 40.12890","~episode_number:  62.544304<br />~n_characters: 39.94322","~episode_number:  66.164557<br />~n_characters: 39.76227","~episode_number:  69.784810<br />~n_characters: 39.58831","~episode_number:  73.405063<br />~n_characters: 39.41913","~episode_number:  77.025316<br />~n_characters: 39.21617","~episode_number:  80.645570<br />~n_characters: 38.97856","~episode_number:  84.265823<br />~n_characters: 38.71702","~episode_number:  87.886076<br />~n_characters: 38.44227","~episode_number:  91.506329<br />~n_characters: 38.16505","~episode_number:  95.126582<br />~n_characters: 37.89606","~episode_number:  98.746835<br />~n_characters: 37.64604","~episode_number: 102.367089<br />~n_characters: 37.42571","~episode_number: 105.987342<br />~n_characters: 37.24578","~episode_number: 109.607595<br />~n_characters: 37.11523","~episode_number: 113.227848<br />~n_characters: 37.02591","~episode_number: 116.848101<br />~n_characters: 36.97063","~episode_number: 120.468354<br />~n_characters: 36.94414","~episode_number: 124.088608<br />~n_characters: 36.94117","~episode_number: 127.708861<br />~n_characters: 36.95648","~episode_number: 131.329114<br />~n_characters: 36.98480","~episode_number: 134.949367<br />~n_characters: 37.02089","~episode_number: 138.569620<br />~n_characters: 37.05947","~episode_number: 142.189873<br />~n_characters: 37.09529","~episode_number: 145.810127<br />~n_characters: 37.13225","~episode_number: 149.430380<br />~n_characters: 37.21732","~episode_number: 153.050633<br />~n_characters: 37.34767","~episode_number: 156.670886<br />~n_characters: 37.51100","~episode_number: 160.291139<br />~n_characters: 37.69505","~episode_number: 163.911392<br />~n_characters: 37.88752","~episode_number: 167.531646<br />~n_characters: 38.07615","~episode_number: 171.151899<br />~n_characters: 38.24865","~episode_number: 174.772152<br />~n_characters: 38.39273","~episode_number: 178.392405<br />~n_characters: 38.49613","~episode_number: 182.012658<br />~n_characters: 38.55556","~episode_number: 185.632911<br />~n_characters: 38.60683","~episode_number: 189.253165<br />~n_characters: 38.65431","~episode_number: 192.873418<br />~n_characters: 38.69703","~episode_number: 196.493671<br />~n_characters: 38.73399","~episode_number: 200.113924<br />~n_characters: 38.76422","~episode_number: 203.734177<br />~n_characters: 38.78672","~episode_number: 207.354430<br />~n_characters: 38.80052","~episode_number: 210.974684<br />~n_characters: 38.80461","~episode_number: 214.594937<br />~n_characters: 38.79803","~episode_number: 218.215190<br />~n_characters: 38.78050","~episode_number: 221.835443<br />~n_characters: 38.75427","~episode_number: 225.455696<br />~n_characters: 38.71950","~episode_number: 229.075949<br />~n_characters: 38.67607","~episode_number: 232.696203<br />~n_characters: 38.62388","~episode_number: 236.316456<br />~n_characters: 38.56279","~episode_number: 239.936709<br />~n_characters: 38.49271","~episode_number: 243.556962<br />~n_characters: 38.41352","~episode_number: 247.177215<br />~n_characters: 38.32509","~episode_number: 250.797468<br />~n_characters: 38.22733","~episode_number: 254.417722<br />~n_characters: 38.12049","~episode_number: 258.037975<br />~n_characters: 38.00572","~episode_number: 261.658228<br />~n_characters: 37.88307","~episode_number: 265.278481<br />~n_characters: 37.75249","~episode_number: 268.898734<br />~n_characters: 37.61392","~episode_number: 272.518987<br />~n_characters: 37.46732","~episode_number: 276.139241<br />~n_characters: 37.31263","~episode_number: 279.759494<br />~n_characters: 37.14981","~episode_number: 283.379747<br />~n_characters: 36.97879","~episode_number: 287.000000<br />~n_characters: 36.79954","~episode_number: 287.000000<br />~n_characters: 36.79954","~episode_number: 287.000000<br />~n_characters: 36.79954","~episode_number: 283.379747<br />~n_characters: 36.97879","~episode_number: 279.759494<br />~n_characters: 37.14981","~episode_number: 276.139241<br />~n_characters: 37.31263","~episode_number: 272.518987<br />~n_characters: 37.46732","~episode_number: 268.898734<br />~n_characters: 37.61392","~episode_number: 265.278481<br />~n_characters: 37.75249","~episode_number: 261.658228<br />~n_characters: 37.88307","~episode_number: 258.037975<br />~n_characters: 38.00572","~episode_number: 254.417722<br />~n_characters: 38.12049","~episode_number: 250.797468<br />~n_characters: 38.22733","~episode_number: 247.177215<br />~n_characters: 38.32509","~episode_number: 243.556962<br />~n_characters: 38.41352","~episode_number: 239.936709<br />~n_characters: 38.49271","~episode_number: 236.316456<br />~n_characters: 38.56279","~episode_number: 232.696203<br />~n_characters: 38.62388","~episode_number: 229.075949<br />~n_characters: 38.67607","~episode_number: 225.455696<br />~n_characters: 38.71950","~episode_number: 221.835443<br />~n_characters: 38.75427","~episode_number: 218.215190<br />~n_characters: 38.78050","~episode_number: 214.594937<br />~n_characters: 38.79803","~episode_number: 210.974684<br />~n_characters: 38.80461","~episode_number: 207.354430<br />~n_characters: 38.80052","~episode_number: 203.734177<br />~n_characters: 38.78672","~episode_number: 200.113924<br />~n_characters: 38.76422","~episode_number: 196.493671<br />~n_characters: 38.73399","~episode_number: 192.873418<br />~n_characters: 38.69703","~episode_number: 189.253165<br />~n_characters: 38.65431","~episode_number: 185.632911<br />~n_characters: 38.60683","~episode_number: 182.012658<br />~n_characters: 38.55556","~episode_number: 178.392405<br />~n_characters: 38.49613","~episode_number: 174.772152<br />~n_characters: 38.39273","~episode_number: 171.151899<br />~n_characters: 38.24865","~episode_number: 167.531646<br />~n_characters: 38.07615","~episode_number: 163.911392<br />~n_characters: 37.88752","~episode_number: 160.291139<br />~n_characters: 37.69505","~episode_number: 156.670886<br />~n_characters: 37.51100","~episode_number: 153.050633<br />~n_characters: 37.34767","~episode_number: 149.430380<br />~n_characters: 37.21732","~episode_number: 145.810127<br />~n_characters: 37.13225","~episode_number: 142.189873<br />~n_characters: 37.09529","~episode_number: 138.569620<br />~n_characters: 37.05947","~episode_number: 134.949367<br />~n_characters: 37.02089","~episode_number: 131.329114<br />~n_characters: 36.98480","~episode_number: 127.708861<br />~n_characters: 36.95648","~episode_number: 124.088608<br />~n_characters: 36.94117","~episode_number: 120.468354<br />~n_characters: 36.94414","~episode_number: 116.848101<br />~n_characters: 36.97063","~episode_number: 113.227848<br />~n_characters: 37.02591","~episode_number: 109.607595<br />~n_characters: 37.11523","~episode_number: 105.987342<br />~n_characters: 37.24578","~episode_number: 102.367089<br />~n_characters: 37.42571","~episode_number:  98.746835<br />~n_characters: 37.64604","~episode_number:  95.126582<br />~n_characters: 37.89606","~episode_number:  91.506329<br />~n_characters: 38.16505","~episode_number:  87.886076<br />~n_characters: 38.44227","~episode_number:  84.265823<br />~n_characters: 38.71702","~episode_number:  80.645570<br />~n_characters: 38.97856","~episode_number:  77.025316<br />~n_characters: 39.21617","~episode_number:  73.405063<br />~n_characters: 39.41913","~episode_number:  69.784810<br />~n_characters: 39.58831","~episode_number:  66.164557<br />~n_characters: 39.76227","~episode_number:  62.544304<br />~n_characters: 39.94322","~episode_number:  58.924051<br />~n_characters: 40.12890","~episode_number:  55.303797<br />~n_characters: 40.31706","~episode_number:  51.683544<br />~n_characters: 40.50545","~episode_number:  48.063291<br />~n_characters: 40.69182","~episode_number:  44.443038<br />~n_characters: 40.87392","~episode_number:  40.822785<br />~n_characters: 41.04950","~episode_number:  37.202532<br />~n_characters: 41.21631","~episode_number:  33.582278<br />~n_characters: 41.37296","~episode_number:  29.962025<br />~n_characters: 41.52149","~episode_number:  26.341772<br />~n_characters: 41.66302","~episode_number:  22.721519<br />~n_characters: 41.79849","~episode_number:  19.101266<br />~n_characters: 41.92886","~episode_number:  15.481013<br />~n_characters: 42.05510","~episode_number:  11.860759<br />~n_characters: 42.17815","~episode_number:   8.240506<br />~n_characters: 42.29896","~episode_number:   4.620253<br />~n_characters: 42.41850","~episode_number:   1.000000<br />~n_characters: 42.53772","~episode_number:   1.000000<br />~n_characters: 42.53772"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(153,153,153,0.4)","hoveron":"points","hoverinfo":"x+y","showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"range":[-13.3,301.3],"tickmode":"array","ticktext":["0","100","200","300"],"tickvals":[0,100,200,300],"categoryorder":"array","categoryarray":["0","100","200","300"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"Episode number","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"range":[3.85,73.15],"tickmode":"array","ticktext":["20","40","60"],"tickvals":[20,40,60],"categoryorder":"array","categoryarray":["20","40","60"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Number of characters in an episode","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"5db43c031bdf":{"x":{},"y":{},"type":"scatter"},"5db43537521":{"x":{},"y":{}}},"cur_data":"5db43c031bdf","visdat":{"5db43c031bdf":["function (y) ","x"],"5db43537521":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script><!--/html_preserve-->

- How many characters are there in the show? A lot!
- But how many of them actually speak a lot?


```r
ggplot(by_character, aes(reorder(character, -n), n, fill = main)) +
	geom_col() +
	labs(
		x = "Character",
		y = "Number of spoken words"
	) +
	theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position = "none") +
	scale_y_continuous(labels = scales::comma) +
	scale_fill_manual(values = binary_colors)
```

![](main_files/figure-html/character_word_count-1.png)<!-- -->

## Comparing the boys


```r
ggplot(by_character_episode, aes(episode_number, mean_sentiment_score, fill = character)) +
	geom_col(show.legend = FALSE) +
	geom_smooth() +
	facet_wrap(~ character) +
	labs(
		x = "Episode number",
		y = "Mean sentiment score"
	) +
	scale_fill_manual(values = character_colors)
```

![](main_files/figure-html/character_sentiments-1.png)<!-- -->


```r
ggplot(by_character_episode, aes(episode_number, n_words, fill = character)) +
	geom_col(show.legend = FALSE) +
	geom_smooth() +
	facet_wrap(~ character) +
	labs(
		x = "Episode number",
		y = "Number of spoken words"
	) +
	scale_fill_manual(values = character_colors)
```

![](main_files/figure-html/character_word_counts-1.png)<!-- -->


```r
top_n_character_words <- count(episode_words, character, word) %>%
	filter(character %in% main_characters) %>%
	arrange(desc(n)) %>%
	group_by(character) %>%
	top_n(10) %>%
	ungroup() %>%
	arrange(character, n) %>%
	# This is needed for proper bar ordering in facets
	# https://drsimonj.svbtle.com/ordering-categories-within-ggplot2-facets
	mutate(order = row_number())

ggplot(top_n_character_words, aes(order, n, fill = character)) +
	geom_col(show.legend = FALSE) +
	facet_wrap(~ character, scales = "free") +
	coord_flip() +
	labs(
		y = "Number of occurrences",
		x = "Top 10 most used words by a character"
	) +
	scale_x_continuous(
		breaks = top_n_character_words$order,
		labels = top_n_character_words$word
	) +
	scale_fill_manual(values = character_colors)
```

![](main_files/figure-html/top_character_words-1.png)<!-- -->

- Let's focus on the boys:
  - how do their sentiments differ
  - how does the amount of words differ
  
## Counting Kenny's deaths


```r
by_ep <- episode_lines %>%
	group_by(episode_name) %>%
	summarise(
		ep_text = glue_collapse(text)
	) %>%
	mutate(kenny_died = str_detect(str_to_lower(ep_text), "killed kenny") | str_detect(str_to_lower(ep_text), "kill kenny"))

sum(by_ep$kenny_died)
```

```
## [1] 51
```

```r
# print(by_ep[by_ep$kenny_died, "episode_name"], n = 100)
```

- How many times do they say: OMG they killed Kenny! You bastards! (So that's a rough counting of Kenny's deaths :-) )

## Are naughtier episodes more popular?


```r
ggplot(by_episode, aes(rating, swear_word_ratio)) +
	geom_point(color = vertabelo_color, alpha = 0.6, size = 3) +
	geom_smooth() +
	scale_y_continuous(labels = scales::percent) +
	scale_x_continuous(breaks = seq(6, 10, 0.5)) +
	labs(
		x = "IMDB rating",
		y = "Episode swear word ratio"
	)
```

![](main_files/figure-html/naugthy_popularity-1.png)<!-- -->

## Is Eric Cartman the naughtiest character?


```r
result <- purrr::map_df(
	top_n_characters(episode_words, 20),
	compare_two_characters,
	"cartman",
	words = episode_words)

ggplot(result, aes(x = reorder(character, -estimate2), estimate2)) +
	geom_errorbar(aes(ymin = conf.low, ymax = conf.high, color = p.value < 0.05)) +
	geom_hline(yintercept = 0, col = "red", linetype = "dashed") +
	labs(
		x = "Characters",
		y = "prop.test estimate",
		title = "Cartman vs other characters (even himself)",
		subtitle = "Negative values mean that the character is naughtier than Cartman and vice versa"
	) +
	ylim(c(-0.4, 0.4)) +
	# scale_color_manual(values = binary_colors) +
	theme(
		axis.text.x = element_text(angle = 60, hjust = 1),
		legend.position = "none"
	)
```

![](main_files/figure-html/eric_naugthiest-1.png)<!-- -->

## Conclusion
